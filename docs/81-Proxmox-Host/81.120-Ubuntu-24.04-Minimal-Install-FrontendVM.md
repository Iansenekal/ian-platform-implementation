# 81.120 Ubuntu 24.04 Minimal Install (AI-FRONTEND01)

Document ID: `docs/81-Proxmox-Host/81.120-Ubuntu-24.04-Minimal-Install-FrontendVM`  
Version: `v1.0`  
Date: `2026-02-10`  
Owner: `Infrastructure / Platform Ops`

## Purpose
Provide a deterministic Ubuntu 24.04 minimal install runbook for `AI-FRONTEND01`, including static IP, DNS, package baseline, and guest-agent enablement.

## Scope
Base OS only. UI/ingress deployment is handled in `20.*` platform docs.

## Prerequisites
- `81.100` VM blueprint approved.
- Ubuntu 24.04 ISO available in Proxmox.
- `vmbr0` networking verified.

## Lab Defaults
- Hostname: `ai-frontend01.lab.local`
- IP/CIDR: `10.10.5.179/24`
- Gateway: `10.10.5.1`
- DNS: `10.10.5.160`
- Domain: `lab.local`
- Timezone: `Africa/Johannesburg`

## 1) Proxmox VM Creation
UI: `Datacenter -> <node> -> Create VM`
- Name: `AI-FRONTEND01`
- ISO: Ubuntu 24.04 server
- BIOS: `OVMF`
- Machine: `q35`
- System disk: `64GB`, SCSI, primary datastore
- CPU: `4 vCPU`
- RAM: `16GB`
- NIC: `VirtIO` on `vmbr0`
- Optional: add data disk (`100GB` to `250GB`)

## 2) Ubuntu Installer (Console)
- Set static network manually:
  - Address: `10.10.5.179/24`
  - Gateway: `10.10.5.1`
  - DNS: `10.10.5.160`
  - Search domain: `lab.local`
- Install OpenSSH server.
- Prefer SSH key install.
- Keep featured snaps minimal.

## 3) First Boot Verification
Inside VM:

```bash
hostnamectl
ip -br addr
ip r | head
resolvectl status | sed -n '1,120p'
timedatectl
systemctl status ssh --no-pager
```

Pass:
- Hostname `ai-frontend01`.
- Static IP present.
- Default route via `10.10.5.1`.
- DNS `10.10.5.160` and domain `lab.local`.
- Timezone `Africa/Johannesburg`.
- SSH active.

## 4) Mandatory Post-install Baseline

```bash
sudo timedatectl set-timezone Africa/Johannesburg
sudo apt-get update
sudo apt-get -y upgrade
sudo apt-get -y autoremove
sudo apt-get install -y curl wget ca-certificates gnupg lsb-release jq unzip zip tar net-tools iproute2 dnsutils ufw fail2ban chrony qemu-guest-agent
sudo systemctl enable --now qemu-guest-agent
sudo systemctl enable --now fail2ban
```

## 5) Netplan Reference (If Re-apply Needed)
File: `/etc/netplan/01-netcfg.yaml`
- Use full replacement from:
  - `infrastructure/vm-provisioning/install/81.120-netplan-01-netcfg.yaml.example`

Apply:

```bash
sudo netplan generate
sudo netplan apply
```

## 6) Baseline Security (Pre-hardening)

```bash
sudo ufw default deny incoming
sudo ufw default allow outgoing
sudo ufw allow from 10.10.5.0/24 to any port 22 proto tcp
sudo ufw enable
sudo ufw status verbose
```

## 7) Sign-off Gate
- VM reachable by SSH.
- Static networking correct.
- Package updates complete.
- Baseline package set installed.
- QEMU guest agent enabled in guest and Proxmox UI.
- Timezone and time sync healthy.
- UFW baseline active.

## 8) Repo Helpers
- Inputs template: `infrastructure/vm-provisioning/install/81.120-ai-frontend01-inputs.env.example`
- Host verification: `infrastructure/vm-provisioning/install/81.120-ai-frontend01-verify.sh`
- Netplan template: `infrastructure/vm-provisioning/install/81.120-netplan-01-netcfg.yaml.example`
- Evidence checklist: `infrastructure/vm-provisioning/install/81.120-evidence-checklist.md`
