# 81.90 Proxmox Host Storage Verification Checklist

Document ID: `docs/81-Proxmox-Host/81.90-Storage-Verification-Checklist`  
Version: `v1.0`  
Date: `2026-02-10`  
Owner: `Infrastructure / Platform Ops`

## Purpose
Provide mandatory post-implementation storage verification: free-space thresholds, platform health checks, I/O sanity, and snapshot rollback proof.

## Scope
Proxmox host storage plus representative VM disk proof.

## Prerequisite
`81.80` storage implementation complete.

## 1) Baseline Evidence
Run on Proxmox host:

```bash
pvesm status
df -hT
lsblk -o NAME,SIZE,TYPE,FSTYPE,MOUNTPOINT,MODEL
mount | head -n 50
```

## 2) Free Space Thresholds
- Primary datastore: warn `>=70%`, critical `>=85%`.
- Backup datastore: warn `>=70%`, critical `>=85%`.
- LVM-thin: never allow `100%` thin pool usage.
- ZFS: target below `80%` to reduce risk/performance issues.

## 3) LVM-thin Checks (if selected)

```bash
lvs -a
vgs
pvs
```

## 4) ZFS Checks (if selected)

```bash
zpool status
zpool list
zfs list
```

## 5) I/O Sanity
Host:

```bash
dmesg -T | tail -n 80
iostat -x 1 3 || true
```

Representative VM:

```bash
df -h
sudo dmesg -T | tail -n 80
sync; dd if=/dev/zero of=/tmp/io_test.bin bs=64M count=4 conv=fdatasync; rm -f /tmp/io_test.bin
```

## 6) Snapshot Rollback Proof (Representative VM)
1. Create snapshot (`snap-proof-1`) in Proxmox UI.
2. Make harmless guest change (`/opt/snaptest/proof.txt`).
3. Roll back snapshot.
4. Confirm VM recovers and change is reverted.

## 7) Backup Store Sanity
- `backup-store` visible and active.
- Content includes `VZDump backup file`.
- Test backup write scheduled per backup runbooks.

## 8) Mandatory Sign-off
- Datastores active and healthy.
- Free-space thresholds respected.
- No storage errors in logs.
- VM I/O smoke test successful.
- Snapshot rollback proof successful.
- Evidence captured and stored.

## 9) Evidence
- Baseline command outputs.
- LVM or ZFS checks.
- Snapshot proof notes and screenshots.
- Storage + Snapshot UI screenshots.

## 10) Repo Helpers
- Inputs: `infrastructure/proxmox/storage/81.90-storage-verify-inputs.env.example`
- Verification collector: `infrastructure/proxmox/storage/81.90-storage-verification.sh`
- Evidence checklist: `infrastructure/proxmox/storage/81.90-evidence-checklist.md`
