# 81.70 Proxmox Host Storage Plan (LVM-thin vs ZFS)

Document ID: `docs/81-Proxmox-Host/81.70-Storage-Plan-LVM-vs-ZFS`  
Version: `v1.0`  
Date: `2026-02-10`  
Owner: `Infrastructure / Platform Ops`

## Purpose
Provide a deterministic storage decision guide for Proxmox host layout (`LVM-thin` vs `ZFS`) aligned to backup/DR and evidence-preservation requirements.

## Scope
Storage planning and decision only. Build/implementation details are handled in subsequent runbooks.

## Hard Requirements
- Deterministic rebuild.
- Backups validated.
- Restore procedure tested.
- Evidence integrity supported with checksums.

## 1) Executive Recommendation (Quick Pick)
| Environment | Recommended default | Why |
|---|---|---|
| Lab / small single-host build | LVM-thin (EXT4) | Simplest and stable with lowest ops overhead |
| Client / multi-disk with redundancy goals | ZFS (mirror/RAIDZ) | Strong integrity + snapshots + resilience |
| Performance-critical NVMe with strong RAM | ZFS mirror or LVM-thin | Choose by redundancy goals + operator skill |

## 2) LVM-thin in Proxmox
- Common installer baseline: `EXT4 + LVM` with thin pool for VM disks.
- Supports thin provisioning, requiring capacity monitoring.
- Operationally simple.
- Does not provide end-to-end checksummed integrity like ZFS.

## 3) ZFS in Proxmox
- Filesystem + volume manager with checksums and snapshots.
- Detect/correct corruption when redundancy exists (mirror/RAIDZ).
- Strong rollback/recovery workflows with snapshots.
- Requires stronger planning (RAM, layout, monitoring, snapshot retention).

## 4) Pros/Cons (Backup + DR Alignment)
| Criteria | LVM-thin | ZFS |
|---|---|---|
| Simplicity | High | Medium |
| Integrity checks | Limited | Strong |
| Snapshot workflows | Basic via Proxmox | Excellent native |
| Thin/capacity risk | Must monitor pool fullness | Must monitor pool + snapshot growth |
| Backup/DR requirement | Mandatory | Still mandatory |
| Evidence preservation | At backup layer | Snapshot support helps but does not replace evidence process |

## 5) Decision Rules
Choose `LVM-thin` when:
- Single-host lab/small environment.
- Speed and simplicity are primary.
- Backup + restore testing discipline already exists.

Choose `ZFS` when:
- 2+ disks available for mirror/RAIDZ design.
- Integrity and resilience are higher priority.
- Team can monitor and operate ZFS confidently.

Do not choose `ZFS` when:
- Single disk is incorrectly expected to provide redundancy.
- Snapshot growth/pool monitoring cannot be maintained.
- RAM constraints are severe for planned workload.

## 6) Backup/DR + Evidence Preservation Alignment
- No storage mode removes backup/restore requirements.
- VM backups and restore procedures from `06.00` to `06.30` remain mandatory.
- Evidence preservation from `06.40` must include checksums and retention.
- Treat host as disposable; keep configuration and data restorable.

## 7) Operational Guardrails
For LVM-thin:
- Alert on thin-pool usage thresholds (example: 70/85/90%).
- Prevent pool exhaustion.

For ZFS:
- Monitor pool health/capacity.
- Schedule scrubs (example monthly, policy-driven).
- Control snapshot retention growth.
- Document disk-to-vdev mapping.

## 8) Minimal Layout Examples
| Scenario | LVM-thin option | ZFS option |
|---|---|---|
| Single NVMe lab | EXT4 + LVM-thin | Single-disk ZFS (integrity only, no redundancy) |
| Two identical SSD/NVMe | LVM-thin on one disk | ZFS mirror (recommended) |
| 4+ disks client server | LVM-thin + RAID controller | ZFS RAIDZ1/RAIDZ2 |

## 9) Storage Decision Verification Gate
- Disk inventory documented (count/type/size/serial where applicable).
- Storage mode selection documented with justification.
- Backup/DR plan confirmed and restore test scheduled.
- Monitoring plan defined.
- Evidence preservation approach confirmed (checksums + retention).

## 10) Client Rollout Variables
| Variable | Client value |
|---|---|
| Storage mode (`lvm_thin` / `zfs`) | `<fill>` |
| Disk inventory | `<fill>` |
| ZFS layout (if used) | `<fill>` |
| LVM-thin sizing policy (if used) | `<fill>` |
| Snapshot policy (if used) | `<fill>` |
| Backup target and retention | `<fill>` |
| Scrub schedule / thin-pool thresholds | `<fill>` |
