# 81.190 VM Provisioning Verification Checklist (Gate to Bootstrap)

Document ID: `docs/81-Proxmox-Host/81.190-VM-Provisioning-Verification-Checklist`  
Version: `v1.0`  
Date: `2026-02-10`  
Owner: `Platform Ops`

## Purpose
Provide a mandatory pass/fail gate after VM provisioning and base hardening. All required checks must pass before deterministic bootstrap and stack installation.

## Targets
- `AI-DATA01`
- `AI-FRONTEND01`
- `DNS01` (optional)

## Prerequisites
- `81.100` blueprints
- `81.110` and `81.120` installs
- `81.150` hardening
- `81.160` access standard

## How To Use
1. Run gate script from admin workstation:
   - `bash infrastructure/vm-provisioning/verification/81.190-vm-provisioning-gate.sh --env-file infrastructure/vm-provisioning/verification/81.190-gate-inputs.env --evidence-dir artifacts/vm-provisioning-gate`
2. Review `summary.txt`.
3. Resolve any fail and re-run.
4. Capture manual Proxmox UI checks and include in evidence.

## Automated Check Coverage
- Admin workstation ping and SSH reachability.
- Per-VM identity and OS sanity.
- Static IP and route.
- DNS and resolver state.
- Time sync and chrony.
- UFW baseline posture.
- SSH posture (`PermitRootLogin`, `PasswordAuthentication`, port).
- Disk/mount sanity and root free space threshold.
- QEMU guest agent status.
- Listening port sanity (pre-bootstrap).

## Manual Proxmox UI Checks
- QEMU Guest Agent enabled for each VM.
- VM Summary shows expected IP.
- VM NIC attached to `vmbr0`.
- No public bridge used.
- Snapshot/backup configuration aligns with policy.

## Gate Criteria
- PASS: all required checks pass and SSH works from allowed admin hosts.
- FAIL (hard-stop):
- wrong IP/gateway/DNS
- NTP not syncing
- UFW not active or too permissive
- password SSH enabled without approved exception
- guest agent missing
- incorrect disk mounts or insufficient free space

## Evidence Requirements
- Proxmox VM Summary screenshots (IPs visible).
- Script output bundle for each VM.
- Exceptions documented and approved.
