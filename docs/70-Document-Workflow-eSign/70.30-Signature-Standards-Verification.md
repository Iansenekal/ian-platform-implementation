# AI Platform Deployment Documentation
## 70.30 Document Workflow + eSign - Signature Standards and Verification

LAN-only - POPIA-friendly - Verifiable signatures - Tamper-evident receipts

Document Control
- Document ID: `docs/70-Document-Workflow-eSign/70.30-Signature-Standards-Verification`
- Filename: `docs/70-Document-Workflow-eSign/70.30-Signature-Standards-Verification.md`
- Version: `v1.0`
- Date: `2026-02-10`
- Owner: Security + Compliance
- Status: Signature Standard
- Hard requirements: verifiable signatures; approval binding to hash + identity + timestamp; secure evidence; no document content in logs
- Related docs: `70.11`, `70.20`, `70.70`, `03.20`, `21.45`

## 1. Purpose
- define on-prem signature and long-term verification model without cloud dependencies
- ensure approvals are evidence-based for compliance audits
- strengthen non-repudiation with identity assurance + MFA + tamper-evident audit trail

## 2. Signature Definition in Scope
- authoritative signature artifact is a signed receipt, not a drawn visual signature
- receipt binds document hash, signer identity, workflow step, and timestamp
- optional PDF visible signature block is supplementary to receipt verification

## 3. Signature Assurance Tiers
- S1: authenticated approval record only (low assurance)
- S2: signed receipt over document hash (default)
- S3: signed receipt plus embedded PDF signature block (high assurance)

## 4. Hash Input Standard
- primary hash: SHA-256 over exact document bytes at approval time
- approvals are version-bound; hashes cannot be reused across versions
- optional secondary hash over normalized metadata fields for correlation
- hash computation must be server-side for deterministic results

## 5. Signature Receipt Schema
Minimum fields:
- `receipt_id`
- `document_id`
- `document_version`
- `document_sha256`
- `workflow_instance_id`
- `step_id`
- `decision`
- `signer_subject`
- `signer_display_name`
- `auth_method`
- `mfa_method`
- `timestamp_utc`
- `policy_version`
- `server_signature`

## 6. Signing Keys and Trust Anchors
- dedicated server-side signing key signs receipts
- verification public key distributed to auditors via controlled channel
- signing keys stored in `/opt/<stack>/secrets/` with strict permissions and rotation controls
- old public keys retained to verify historical receipts after key rotation

## 7. Verification Process
1. Compute SHA-256 on final document bytes.
2. Retrieve corresponding signature receipt from Evidence-Pack.
3. Compare computed hash with `document_sha256`.
4. Verify `server_signature` with trusted public key.
5. Validate signer subject and step against approval chain.
6. Confirm audit events for workflow/MFA/timing integrity.

## 8. PDF Embedded Signature Blocks (Optional)
- optional visible block in exported PDF for user presentation
- authoritative verification remains receipt + hash + signed payload
- embedded block should reference `receipt_id` and `document_sha256`

## 9. Threat Model and Mitigations
- post-approval tampering detected via hash mismatch
- impersonation mitigated by IdP auth + MFA
- receipt tampering mitigated by receipt signature verification
- key compromise mitigated by key isolation, rotation, and incident response
- time tampering mitigated by NTP and server-side UTC timestamps

## 10. Retention and Evidence Handling
- receipts and audit summaries typically retained longer than working drafts
- Evidence-Pack restricted to audit/compliance/admin roles
- legal hold preserves both document and receipt where required

## 11. Verification Checklist
1. Approve test document and confirm receipt generation in Evidence-Pack.
2. Confirm SHA-256(document) equals receipt `document_sha256`.
3. Verify receipt signature using approved public verification key.
4. Rotate signing key in test and confirm historical verification still works with retained old key.
5. Modify approved document and confirm verification fails (hash mismatch).

## 12. Client Rollout Variables
- signature assurance tier (S2 default)
- embedded PDF signature block enablement
- key rotation interval
- Evidence-Pack retention duration
- auditors/key custodians for public verification keys
