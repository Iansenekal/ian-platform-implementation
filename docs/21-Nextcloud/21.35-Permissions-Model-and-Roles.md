# AI Platform Deployment Documentation
## 21.35 Nextcloud - Permissions Model and Roles (Granular Access)

LAN-only - POPIA-friendly - Two-VM on Proxmox - Ubuntu 24.04

Document Control
- Document ID: `docs/21-Nextcloud/21.35-Permissions-Model-and-Roles`
- Filename: `docs/21-Nextcloud/21.35-Permissions-Model-and-Roles.md`
- Version: `v1.0`
- Date: `2026-02-09`
- Owner: Choice IT / Security Architecture + Platform Governance
- Status: Mandatory - apply before project onboarding
- Scope: Authorization model (roles and permissions). Authentication is defined in `21.30`.
- Hard requirements: least privilege; separation of duties; explicit read-only roles; non-interactive service accounts
- Related docs: `04.40`, `11.70`, `21.36`, `21.37`, `21.38`
- Evidence requirement: role tests + sample project folder proof + audit evidence
- Time zone: `Africa/Johannesburg`
- Default stance: deny-by-default at project roots; explicit grants by group only
- Note: canonical Nextcloud RBAC model for all rollouts

## 1. Core Principles
- deny-by-default
- group-based access, not per-user root sharing
- separation of duties between platform and project governance
- read-only as first-class role
- service accounts are non-interactive and least-privileged
- external sharing off by default
- access grants/revocations must be auditable

## 2. Role Catalog
Platform-level roles:
- `NC-Platform-Admin` (Tier 0): platform config and operations; not implicit project-data owner
- `NC-Security-Audit-ReadOnly` (Tier 1): read-only evidence visibility
- `NC-Helpdesk-Operator` (optional): support diagnostics, no ACL-approval authority

Project-level roles:
- `Project-Owner`
- `Project-Editor`
- `Project-Viewer` (read-only)
- `Project-Contributor` (optional upload-limited role)
- `Project-Auditor` (optional read/evidence export)

System roles:
- `Search-Indexer-Service`
- `Automation-Service`
- `Backup-Service`

## 3. Permission Matrix
Baseline expectations:
- Platform Admin: manages settings/apps only
- Security Audit RO: views logs/evidence only
- Project Owner: controls project membership and exceptions
- Project Editor: upload/edit in scope
- Project Viewer: view/download only
- Service accounts: scoped read/use only, no interactive session

## 4. Group-Based Access Model
- Access granted via groups only.
- Preferred source: IdP/AD group mapping.
- Per-user shares at project root are forbidden except documented break-glass.
- Project root ACL changes require Project Owner approval.

Minimum group set per project:
- `AI-NC-PROJ-<CODE>-OWNER`
- `AI-NC-PROJ-<CODE>-EDIT`
- `AI-NC-PROJ-<CODE>-VIEW`

## 5. Service Accounts and Connector Permissions
- never used for interactive human login
- per-connector/per-scope accounts
- Search/KG indexer read-only and ACL-aware
- automation accounts restricted to approved folders
- backup account restricted to backup datasets/exports

Protections:
- secrets in `/opt/<stack>/secrets`
- rotation and lockout controls
- allowlist restrictions where MFA is not possible

## 6. Sharing and Collaboration Rules
- external sharing disabled by default
- internal sharing restricted to in-project scope
- cross-project sharing requires formal approval
- public links (exception only): time-bound, protected, audited
- no anonymous upload unless explicitly approved

## 7. Admin Boundaries and Separation of Duties
- platform admins: runtime/platform management, not default project owners
- project owners: project access intent, not platform security owners
- security/audit: visibility without mutation rights
- helpdesk: assistance without access approval authority

## 8. Access Review and Lifecycle
- scheduled project-group reviews (monthly/quarterly)
- remove stale access promptly
- disable accounts via authoritative identity source
- retention and legal-hold constraints apply to deletion

## 9. Verification Checklist
- user without project group sees no project roots
- viewer cannot upload/edit/delete
- editor can upload/edit in scope only
- owner can manage membership through approved workflow
- audit role can read evidence but not modify
- service account cannot use interactive login path
- external sharing disabled by default

## 10. Client Rollout Variables
- platform admin group
- security audit read-only group
- optional helpdesk group
- project group pattern (`OWNER/EDIT/VIEW`)
- external sharing default and exception process
- share expiry and approval workflow
- service account names and scopes
- break-glass controls
- access review cadence and offboarding SLA
