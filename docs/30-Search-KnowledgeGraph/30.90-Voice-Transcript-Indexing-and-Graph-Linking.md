# AI Platform Deployment Documentation
## 30.90 Search & Knowledge Graph - Voice Transcript Indexing and Graph Linking

LAN-only - ACL-respecting search - Mind-map relevance linking

Document Control
- Document ID: `docs/30-Search-KnowledgeGraph/30.90-Voice-Transcript-Indexing-and-Graph-Linking`
- Filename: `docs/30-Search-KnowledgeGraph/30.90-Voice-Transcript-Indexing-and-Graph-Linking.md`
- Version: `v1.0`
- Date: `2026-02-10`
- Owner: Search + Platform
- Status: Design + operational standard
- Hard requirements: ACL-respecting indexing; Nextcloud-authoritative transcript storage; permission-filtered graph visualization; retention/minimization enforcement
- Related docs: `60.*`, `30.10`, `30.15`, `30.50`, `30.70`

## 1. Purpose
- make voice transcripts searchable with other approved sources
- link transcript content to projects, documents, and entities in a permission-safe graph
- enable hover/click relevance without unauthorized disclosure

## 2. Inputs and Outputs
- inputs: audio artifacts, transcript text, speaker/time markers, transcript metadata
- outputs: searchable transcript documents, extracted entities/topics, graph edges, UI relevance signals

## 3. High-Level Indexing Pipeline
1. Audio is stored in Nextcloud under controlled project folders.
2. Transcription writes transcript artifacts into the same project context.
3. Indexer reads only allowed scope using a least-privilege service account.
4. Indexer extracts keywords, entities, project tags, references, and timestamps.
5. Indexer writes normalized records to OpenSearch with ACL metadata.
6. Graph builder creates permitted transcript-project-document-entity-topic links.

## 4. ACL and Permissions Handling
- Nextcloud ACLs are source-of-truth for transcript visibility.
- indexed transcript records must carry permission fields (`acl_groups`, `acl_users` where required).
- query-time filtering must use effective requesting-user principals.
- graph rendering must be permission-filtered per session; no global pre-render of hidden nodes.
- Evidence-Pack and compliance-only folders are hidden from standard roles by default.

## 5. Transcript Indexing Data Model
Recommended fields:
- `transcript_id`
- `project_id`
- `source_path`
- `created_at`
- `speakers`
- `content`
- `topics`
- `entities`
- `referenced_docs`
- `acl_groups`
- `retention_class`

## 6. Graph Linking Rules
### 6.1 Node types
- Transcript
- Project
- Document
- Person/Role (optional)
- Topic/Entity

### 6.2 Edge types
- Transcript -> Project (`belongs_to`)
- Transcript -> Document (`mentions` / `references`)
- Transcript -> Topic/Entity (`discusses`)
- Document <-> Topic (`about`)

### 6.3 Relevance scoring
- score uses explicit references, semantic similarity, recency, and optional interaction signals
- prioritize explicit references over inferred similarity edges
- re-score after permission filtering and suppress inaccessible edges/nodes

## 7. Mind-Map UI Behaviors (Permission-Safe)
- hover transcript node: show permitted related items only
- click transcript node: open viewer + metadata + related list scoped by ACL
- click edge: show relationship reason (explicit reference or similarity)
- provide "Why am I seeing this?" explanation for trust and auditability

## 8. Privacy, Minimization, and Retention
- apply transcript retention classes and purge schedules per `60.50` and `30.70`
- support source redaction before indexing for sensitive classes
- for sensitive classes, allow excerpt-only or embedding-only indexing by policy
- never store raw audio inside search index

## 9. Operational Verification Checklist
1. Restricted-folder transcript is searchable only by authorized users.
2. Unauthorized users do not see transcript nodes or linked graph nodes.
3. Authorized users see transcript nodes and relevance-ranked related items.
4. Retention purge removes transcript from index and graph on expiry.
5. Indexing/access audit events are emitted and reviewable.

## 10. Client Rollout Variables
- transcript retention classes and periods
- indexing scope (Nextcloud folders)
- graph node types enabled (including person nodes)
- relevance thresholds for explicit and inferred edges
- redaction policy by project/class
- external connectors enabled (SharePoint/Teams/OneDrive)
