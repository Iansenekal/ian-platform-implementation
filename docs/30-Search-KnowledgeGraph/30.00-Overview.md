# AI Platform Deployment Documentation
## 30.00 Search + Knowledge Graph - Overview

LAN-only runtime - POPIA-friendly - Two-VM on Proxmox - Ubuntu 24.04

Document Control
- Document ID: `docs/30-Search-KnowledgeGraph/30.00-Overview`
- Filename: `docs/30-Search-KnowledgeGraph/30.00-Overview.md`
- Version: `v1.0`
- Date: `2026-02-09`
- Owner: Choice IT / Platform Architecture + Search Engineering
- Status: Approved design baseline
- Scope: architecture, boundaries, connectors, indexing model, and mind-map UX expectations
- Hard requirements: LAN-only runtime; least privilege; ACL inheritance; auditability; retention controls
- Related docs: `01.*`, `02.*`, `03.*`, `21.*`, `50.*`, `06.*`
- Primary services: OpenSearch, Postgres, Tika (AI-DATA01)
- Primary UI path: AI-FRONTEND01 UI -> Gateway/Search API -> AI-DATA01 services
- Default stance: index permitted metadata/content only; never display unauthorized results

## 1. Module Boundaries
What it is:
- unified enterprise search across approved sources
- knowledge graph over projects/files/entities/topics
- permission-aware mind-map UX

What it is not:
- not source-of-truth storage replacement
- not open web crawler
- not unrestricted search surface

## 2. Outcomes and Success Criteria
- single query plane for authorized content
- zero ACL leakage in search and graph responses
- resilient indexing with observable connector operations
- POPIA-minimized indexing and retention-aligned storage
- auditable connector runs and permission mapping behavior

## 3. High-Level Architecture
Core components:
- Search API on AI-DATA01 behind gateway
- OpenSearch for searchable index
- Tika for controlled extraction
- Postgres-backed KG store (baseline)
- connector workers for source discovery/ACL capture/index write
- frontend mind-map/search UX via AI-FRONTEND01 only

Trust boundaries:
- UI never talks directly to OpenSearch
- backend services use localhost/internal-only paths where possible
- connectors use least-privilege service credentials

## 4. Data Sources and Connectors
Default on-prem:
- Nextcloud (primary)
- optional SMB sources
- optional local-device mediated ingestion

Optional external connectors:
- M365 (SharePoint/OneDrive/Teams) by explicit enablement
- core runtime remains on-prem even when optional connectors are enabled

Connector policy:
- least privilege and scoped access
- no secrets in code
- ACL fidelity required
- minimized collection/exclusion rules
- auditable run summaries

## 5. Indexing Pipeline
Stages:
1. discovery
2. metadata capture
3. ACL capture
4. extraction allowlist via Tika
5. optional enrichment
6. OpenSearch/KG writes
7. validation and sampling

Guardrails:
- file-type allowlist
- size/time limits
- metadata-only mode for sensitive sources unless approved

## 6. ACL Inheritance Model (Non-Negotiable)
- source permissions are authoritative
- index-time ACL tagging + query-time group filtering
- graph applies equivalent node/edge visibility rules

Anti-leakage:
- no existence/title/snippet/adjacency leakage for unauthorized objects

## 7. Knowledge Graph and Mind-Map
Model elements:
- project codes, folders, files
- optional entities/topics
- relationship edges (belongs-to, references, related-to, similar-to)

Purpose:
- relevance via relationships
- permission-safe contextual discovery

## 8. UX Expectations
Search:
- filters by source/project/date/type/sensitivity
- relevance + explainability hint
- open-in-source behavior

Mind-map:
- project-centric clusters
- hover/click metadata panels
- permission-aware rendering (no placeholders for hidden nodes)

## 9. Security and POPIA Controls
- metadata-first indexing default
- approved inclusion for content extraction
- retention/deletion propagation aligned to policy
- query/connector/audit logging with privacy controls

## 10. Operational Model
- monitor API latency, indexing lag, connector health, OpenSearch status
- include OpenSearch + KG store in backup/restore scope
- run capacity checks for index growth and extraction load

## 11. Client Rollout Variables
- enabled sources and connector scope
- content indexing mode per source
- extraction limits and file allowlist
- project-code extraction rule
- group claim strategy
- retention windows and deletion SLA
- indexing schedules and concurrency
- mind-map node types and visibility rules
