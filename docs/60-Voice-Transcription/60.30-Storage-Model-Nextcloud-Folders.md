# AI Platform Deployment Documentation
## 60.30 Voice + Transcription (Whisper) - Storage Model (Nextcloud Folders)

LAN-only runtime - POPIA-friendly - Nextcloud is the source of truth

Document Control
- Document ID: `docs/60-Voice-Transcription/60.30-Storage-Model-Nextcloud-Folders`
- Filename: `docs/60-Voice-Transcription/60.30-Storage-Model-Nextcloud-Folders.md`
- Version: `v1.0`
- Date: `2026-02-10`
- Owner: Choice IT / Platform Ops + Compliance
- Status: Storage Standard
- Hard requirements: Nextcloud authoritative store; strict ACLs; auditable state transitions; class-based retention
- Related docs: `21.37`, `60.20`, `60.40`, `60.50`, `60.60`, `30.15`

## 1. Storage Principles
- Nextcloud is the single source of truth for voice artifacts and transcripts
- project folder ACL boundaries are authoritative for visibility/discovery
- all artifacts require classification metadata (sensitivity, retention, indexing rule)
- lifecycle state is represented by controlled folder placement + metadata sidecar
- no orphan/unscoped artifacts

## 2. High-Level Blueprint
Canonical root per project:
- `/Nextcloud/<Tenant>/Projects/<ProjectCode>/Voice/`

Required subfolders:
- `00-README-Voice-Policy`
- `10-Intake`
- `20-Work-InProgress`
- `30-PendingReview`
- `40-Final`
- `50-Evidence-Pack`
- `60-Exports-Restricted`
- `90-System-Internal`

## 3. Canonical Folder Purposes
- Intake for new uploads and classification checks
- Work-InProgress for machine-only intermediate processing
- PendingReview for review-gated transcripts prior to indexing
- Final for approved/index-eligible artifacts
- Evidence-Pack for compliance and audit materials
- Exports-Restricted for controlled outbound artifacts
- System-Internal for service receipts and manifests only

## 4. State Model
- Intake -> Work-InProgress -> PendingReview (if review required) -> Final
- Evidence-Pack is updated on approval/export/purge events
- only Final is index-eligible by default

## 5. Naming Conventions
Canonical patterns:
- audio: `<ProjectCode>_<YYYYMMDD-HHMM>_<RecordingID>_<Type>.<ext>`
- transcript: `<ProjectCode>_<YYYYMMDD-HHMM>_<RecordingID>_TRANSCRIPT.<ext>`
- segments: `<ProjectCode>_<YYYYMMDD-HHMM>_<RecordingID>_SEGMENTS.json`
- metadata: `<ProjectCode>_<YYYYMMDD-HHMM>_<RecordingID>_META.json`
- job receipt: `<ProjectCode>_<YYYYMMDD-HHMM>_<RecordingID>_JOB.json`

## 6. Required Metadata Sidecar
Minimum required fields:
- recording_id
- project_code
- created_at
- source_type
- sensitivity_label
- retention_class
- indexing_mode
- review_required
- owner_group
- allowed_groups
- language

Recommended optional fields:
- purpose_tag
- meeting_series_id
- department_code
- tags
- speaker_labels_enabled
- redaction_required
- related_document_refs
- legal_hold

## 7. Lifecycle Rules
1. upload lands in Intake with META sidecar present
2. job creation requires complete classification
3. worker outputs intermediate files only to Work-InProgress
4. review-required transcripts remain in PendingReview and non-indexed
5. approved transcripts move to Final and become index-eligible
6. Evidence-Pack is updated on approvals/exports
7. retention purge executes with auditable outputs

All state moves must emit structured audit events with actor, from/to path, timestamp, and reason.

## 8. Sensitive Handling
- Restricted classes default to review_required=true and indexing_mode=after_review
- Confidential classes require narrowed access lists and optional review gates
- Legal hold blocks purge until released and must be tracked in evidence artifacts

## 9. Search/Graph Hooks
- only Final folder content indexes by default
- metadata sidecar drives ACL and graph linkage fields
- restricted classes must avoid person-node linkage unless explicitly approved

## 10. Backup Scope
- include Voice folders and Evidence-Pack in backups
- Work-InProgress exclusion allowed only if explicitly approved and deterministic replay is proven
- restore tests must confirm folder structure and ACL integrity

## 11. Verification Checklist
- canonical folder tree exists for test project
- uploaded audio has required META sidecar fields
- intermediate outputs stay in Work-InProgress
- review-required transcripts stay non-indexed until approval
- approved transcripts move to Final and are searchable only by permitted users
- Evidence-Pack receives expected artifacts

## 12. Client Rollout Variables
- tenant root and project code pattern
- default sensitivity/retention per source type
- indexing mode defaults and review matrix
- export policy and legal hold ownership
